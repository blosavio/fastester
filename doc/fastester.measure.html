<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>fastester.measure documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Fastester</span> <span class="project-version">version 0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1"><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fastester</span></div></div></li><li class="depth-2 branch"><a href="fastester.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="fastester.display.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>display</span></div></a></li><li class="depth-2 current"><a href="fastester.measure.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>measure</span></div></a></li></ul><ul class="index-link"><li class="depth-1"><a href="https://github.com/blosavio/fastester">Project home</a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="fastester.measure.html#var-*lightning-benchmark-opts*"><div class="inner"><span>*lightning-benchmark-opts*</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-clear-registry.21"><div class="inner"><span>clear-registry!</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-create-results-directories"><div class="inner"><span>create-results-directories</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-date"><div class="inner"><span>date</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-defbench"><div class="inner"><span>defbench</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-defbench*"><div class="inner"><span>defbench*</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-range-pow-10"><div class="inner"><span>range-pow-10</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-range-pow-2"><div class="inner"><span>range-pow-2</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-registry"><div class="inner"><span>registry</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-run-all-benchmarks"><div class="inner"><span>run-all-benchmarks</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-run-one-benchmark"><div class="inner"><span>run-one-benchmark</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-run-one-registered-benchmark"><div class="inner"><span>run-one-registered-benchmark</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-run-save-benchmark"><div class="inner"><span>run-save-benchmark</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-run-selected-benchmarks"><div class="inner"><span>run-selected-benchmarks</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-undefbench"><div class="inner"><span>undefbench</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-undefbench*"><div class="inner"><span>undefbench*</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">fastester.measure</h1><div class="doc"><div class="markdown"><p>Define and run tests that objectively measure a function’s evaluation time.</p>
<p>The general idea is to run the performance test suite once per release. Any performance improvement/regression is objectively measured and included in the changelog/release notes.</p>
<p>The <a href="https://github.com/hugoduncan/criterium/">Criterium</a> library does all the actual performance measurements.</p>
<p>See <a href="fastester.display.html">fastester.display</a> for utilities that create an html document with charts and tables that communicate those results.</p>
</div></div><div class="public anchor" id="var-*lightning-benchmark-opts*"><h3>*lightning-benchmark-opts*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Criterium options with extremely minimal samples, etc. Use only for quick, proof-of-concept runs.</p>
<p>Example:</p>
<pre><code class="language-clojure">  (criterium.core/benchmark (+ 1 2) *lightning-benchmark-opts*)
</code></pre>
<p>See also <a href="https://github.com/hugoduncan/criterium/blob/bb10582ded6de31b4b985dc31d501db604c0e461/src/criterium/core.clj#L83"><code>criterium.core/*default-benchmark-opts*</code></a> and <a href="https://github.com/hugoduncan/criterium/blob/bb10582ded6de31b4b985dc31d501db604c0e461/src/criterium/core.clj#L92"><code>criterium.core/*default-quick-bench-opts*</code></a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L228">view source</a></div></div><div class="public anchor" id="var-clear-registry.21"><h3>clear-registry!</h3><div class="usage"><code>(clear-registry!)</code></div><div class="doc"><div class="markdown"><p>Remove all entries from <a href="fastester.measure.html#var-registry">registry</a>, thereby eliminating all defined benchmarking tests.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L55">view source</a></div></div><div class="public anchor" id="var-create-results-directories"><h3>create-results-directories</h3><div class="usage"><code>(create-results-directories excludes)</code></div><div class="doc"><div class="markdown"><p>Create directories to contain measurement results, location declared by options key <code>:results-directory</code>. Consults names contained in set <code>excludes</code>. If zero performance tests are to be executed (i.e., all tests are excluded), directories are not created.</p>
<p>Creates <code>&lt;options-results-dir&gt;/</code> then <code>&lt;options-results-dir&gt;/&lt;version&gt;/</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L166">view source</a></div></div><div class="public anchor" id="var-date"><h3>date</h3><div class="usage"><code>(date)</code></div><div class="doc"><div class="markdown"><p>Returns hashmap of <code>{:year YYYY :month "M..." :day DD}</code>.</p>
<p>Example:</p>
<pre><code class="language-clojure">(date) ;; =&gt; {:year 2025, :month "July", :day 16}
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L289">view source</a></div></div><div class="public anchor" id="var-defbench"><h3>defbench</h3><h4 class="type">macro</h4><div class="usage"><code>(defbench name group f n)</code></div><div class="doc"><div class="markdown"><p>Define and register a benchmark.</p>
<ul>
<li><code>name</code> is an unquoted symbol that labels the performance test.</li>
<li><code>group</code> is a string, shared between multiple conceptually-related performance tests.</li>
<li><code>f</code> is a 1-arity function that measures some performance aspect. Its single argument is the “n” in <em>big-O</em> notation. <code>f</code> may be supplied as an S-expression or a function object. Supplying <code>f</code> as an S-expression has the advantage that the definition may later convey some meaning, e.g., <code>(fn [n] (+ n n))</code>, in the html charts and tables, whereas a function object will render less meaningfully, e.g., <code>#function[fastester.measure/eval11540/fn--11541]</code>.</li>
<li><code>n</code> is a sequence of one or more arguments. During performance testing, elements of <code>n</code> will be individually supplied to the benchmarking utility.</li>
</ul>
<p>Example, supplying <code>f</code> as an S-expression:</p>
<pre><code class="language-clojure">(defbench add-two "benchmarking addition" (fn [n] (+ n n)) [1 10 100 1000])
</code></pre>
<p>Example, supplying <code>f</code> as a function object:</p>
<pre><code class="language-clojure">(defn my-fn-obj [q] (+ q q q))

(defbench add-three "benchmarking additon" my-fn-obj [2 20 200 2000])
</code></pre>
<p>Both examples above share the same <code>group</code> label (“benchmarking addition”), both involving measuring the performance of <code>+</code>. Putting them in the same group signifies that they are conceptually associated, and the html document will aggregate them under a single subsection. Also notice that the <code>n</code> sequences need not be identical.</p>
<p>Note: Invoking a <code>defbench</code> expression, editing the <code>name</code>, followed by invoking <code>defbench</code> a second time, registers two unique performance tests. When developing at the REPL, be aware that the registry may become ‘stale’ with outdated tests.</p>
<ol>
<li>To remove a single, unwanted test, use <a href="fastester.measure.html#var-undefbench">undefbench</a>.</li>
<li>To put the registry into a state that reflects only the current definitions, use <a href="fastester.measure.html#var-clear-registry.21">clear-registry!</a> and re-evaluate the namespace to invoke all the current <code>defbench</code>s .</li>
</ol>
<p>See <a href="fastester.measure.html#var-defbench*">defbench*</a> for the function version.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L80">view source</a></div></div><div class="public anchor" id="var-defbench*"><h3>defbench*</h3><div class="usage"><code>(defbench* name group f n)</code></div><div class="doc"><div class="markdown"><p>Function version of <code>defbench</code> macro. Define and register a benchmark. See <a href="fastester.measure.html#var-defbench">defbench</a> documentation for full details. The differences are that <code>name</code> and <code>f</code> are supplied as a quoted symbols.</p>
<p>Example:</p>
<pre><code class="language-clojure">(defbench* 'add-four "benchmarking addition" '(fn [z] (+ z z z z) [1 10 100])
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L63">view source</a></div></div><div class="public anchor" id="var-range-pow-10"><h3>range-pow-10</h3><div class="usage"><code>(range-pow-10 i)</code></div><div class="doc"><div class="markdown"><p>Given integer <code>i</code>, returns a sequence of <code>[10^0...10^i]</code>, inclusive. Useful for supplying to benchmarking functions.</p>
<p>Examples:</p>
<pre><code class="language-clojure">(range-pow-10 3) ;; =&gt; (1 10 100 1000)
(range-pow-10 6) ;; =&gt; (1 10 100 1000 10000 100000 1000000)
</code></pre>
<p>See also <a href="fastester.measure.html#var-range-pow-2">range-pow-2</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L533">view source</a></div></div><div class="public anchor" id="var-range-pow-2"><h3>range-pow-2</h3><div class="usage"><code>(range-pow-2 i)</code></div><div class="doc"><div class="markdown"><p>Given integer <code>i</code>, returns a sequence of <code>[2^0...2^i]</code>, inclusive. Useful for supplying to benchmarking functions.</p>
<p>Example:</p>
<pre><code class="language-clojure">(range-pow-2 8) ;; (1 2 4 8 16 32 64 128 256)
</code></pre>
<p>See also <a href="fastester.measure.html#var-range-pow-10">range-pow-10</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L549">view source</a></div></div><div class="public anchor" id="var-registry"><h3>registry</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>An atom containing a hashmap of performance tests to run. Typically populated by invoking <a href="fastester.measure.html#var-defbench">defbench</a> or <a href="fastester.measure.html#var-defbench*">defbench*</a>, not manipulated directly.</p>
<p>See also <a href="fastester.measure.html#var-undefbench">undefbench</a> and <a href="fastester.measure.html#var-clear-registry.21">clear-registry!</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L51">view source</a></div></div><div class="public anchor" id="var-run-all-benchmarks"><h3>run-all-benchmarks</h3><div class="usage"><code>(run-all-benchmarks)</code></div><div class="doc"><div class="markdown"><p>Execute all performance tests, ignoring options key <code>:excludes</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L510">view source</a></div></div><div class="public anchor" id="var-run-one-benchmark"><h3>run-one-benchmark</h3><h4 class="type">macro</h4><div class="usage"><code>(run-one-benchmark fexpr arg thoroughness)</code></div><div class="doc"><div class="markdown"><p>Given 1-arity, S-expression <code>fexpr</code> representing a function and argument <code>arg</code>, run one benchmark test using keyword <code>thoroughness</code> to designate the Criterium options, sending result to *<code>out</code>*.</p>
<p><code>thoroughness</code> is one of <code>:default</code>, <code>:quick</code>, or <code>:lightning</code>.</p>
<p>Example:</p>
<pre><code class="language-clojure">(run-one-benchmark (fn [n] (+ n n)) 9 :lightning)
</code></pre>
<p>See <a href="fastester.measure.html#var-run-one-registered-benchmark">run-one-registered-benchmark</a> and <a href="fastester.measure.html#var-*lightning-benchmark-opts*">*lightning-benchmark-opts*</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L245">view source</a></div></div><div class="public anchor" id="var-run-one-registered-benchmark"><h3>run-one-registered-benchmark</h3><h4 class="type">macro</h4><div class="usage"><code>(run-one-registered-benchmark name thoroughness)</code></div><div class="doc"><div class="markdown"><p>Given benchmark registered by <code>name</code>, and a keyword <code>thoroughness</code> that designates the Criterium options, runs benchmarks. Returns a map with keys provided by the benchmark arguments <code>n</code> associated with the benchmark results.</p>
<p><code>thoroughness</code> is one of <code>:default</code>, <code>:quick</code>, or <code>:lightning</code>.</p>
<p>Example:</p>
<pre><code class="language-clojure">(defbench my-bench "my-group" (fn [x] (inc x)) [97 98 99])

(run-one-registered-benchmark my-bench :lightning)
</code></pre>
<p>See <a href="fastester.measure.html#var-run-one-benchmark">run-one-benchmark</a> and <a href="fastester.measure.html#var-*lightning-benchmark-opts*">*lightning-benchmark-opts*</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L263">view source</a></div></div><div class="public anchor" id="var-run-save-benchmark"><h3>run-save-benchmark</h3><div class="usage"><code>(run-save-benchmark ver name group f fexpr arg idx opts)</code></div><div class="doc"><div class="markdown"><p>Given version string <code>ver</code>, string <code>name</code>, test group string <code>group</code>, function object <code>f</code>, function S-expression <code>fexpr</code>, test argument <code>arg</code>, option hashmap <code>opts</code>, and index integer <code>idx</code>, measures the evaluation time under the current benchmark settings and saves results to filesystem.</p>
<p>Example:</p>
<pre><code class="language-clojure">(run-save-benchmark "77-SNAPSHOT7"
                    'mult-two-nums
                    "adding --- stuff"
                    (fn [n] (* n n))
                    '(fn [n] (* n n))
                    22
                    5
                    options)
</code></pre>
<p>See also <a href="fastester.measure.html#var-run-one-benchmark">run-one-benchmark</a> and <a href="fastester.measure.html#var-run-one-registered-benchmark">run-one-registered-benchmark</a> for utilities to quickly benchmark an expression.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L335">view source</a></div></div><div class="public anchor" id="var-run-selected-benchmarks"><h3>run-selected-benchmarks</h3><div class="usage"><code>(run-selected-benchmarks)</code></div><div class="doc"><div class="markdown"><p>Execute performance tests, skipping any tests with name contained in option <code>:excludes</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L517">view source</a></div></div><div class="public anchor" id="var-undefbench"><h3>undefbench</h3><h4 class="type">macro</h4><div class="usage"><code>(undefbench name)</code></div><div class="doc"><div class="markdown"><p>Undefine a performance test by removing <code>name</code> from the registry.</p>
<p>Example:</p>
<pre><code class="language-clojure">;; define a performance test
(defbench add-two "benchmarking addition" (fn [n] (+ n n)) [1 10 100 1000])

;; undefine that performance test
(undefbench add-two)
</code></pre>
<p>See also <a href="fastester.measure.html#var-undefbench*">undefbench*</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L148">view source</a></div></div><div class="public anchor" id="var-undefbench*"><h3>undefbench*</h3><div class="usage"><code>(undefbench* name)</code></div><div class="doc"><div class="markdown"><p>Function version of <a href="fastester.measure.html#var-undefbench">undefbench</a>. Undefines a performance test by removing quoted symbol <code>name</code> from the registry.</p>
<p>Example:</p>
<pre><code class="language-clojure">;; define a performance test
(defbench* 'add-four "benchmarking addition" '(fn [z] (+ z z z z) [1 10 100])

;; undefine that performance test
(undefbench* 'add-four)
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L131">view source</a></div></div></div></body></html>