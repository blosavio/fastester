<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>fastester.measure documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Fastester</span> <span class="project-version">version 0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1"><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fastester</span></div></div></li><li class="depth-2 branch"><a href="fastester.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="fastester.display.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>display</span></div></a></li><li class="depth-2 current"><a href="fastester.measure.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>measure</span></div></a></li></ul><ul class="index-link"><li class="depth-1"><a href="https://github.com/blosavio/fastester">Project home</a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="fastester.measure.html#var-*lightning-benchmark-opts*"><div class="inner"><span>*lightning-benchmark-opts*</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-*performance-testing-options*"><div class="inner"><span>*performance-testing-options*</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-clear-performance-test-registry.21"><div class="inner"><span>clear-performance-test-registry!</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-create-results-directories"><div class="inner"><span>create-results-directories</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-date"><div class="inner"><span>date</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-defperf"><div class="inner"><span>defperf</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-do-all-performance-tests"><div class="inner"><span>do-all-performance-tests</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-do-selected-performance-tests"><div class="inner"><span>do-selected-performance-tests</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-performance-test-registry"><div class="inner"><span>performance-test-registry</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-range-pow-10"><div class="inner"><span>range-pow-10</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-range-pow-2"><div class="inner"><span>range-pow-2</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-run-one-test"><div class="inner"><span>run-one-test</span></div></a></li><li class="depth-1"><a href="fastester.measure.html#var-run-one-test-subroutine"><div class="inner"><span>run-one-test-subroutine</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">fastester.measure</h1><div class="doc"><div class="markdown"><p>Define and run tests that objectively measure a function’s evaluation time.</p>
<p>The general idea is to run the performance test suite once per version. Any performance improvement/regression is objectively measured.</p>
<p>See <a href="fastester.display.html">fastester.display</a> for utilities that create an html display with charts and tables to communicate those results.</p>
</div></div><div class="public anchor" id="var-*lightning-benchmark-opts*"><h3>*lightning-benchmark-opts*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Criterium benchmark options with extremely minimal samples, etc. Use only for quick, proof-of-concept runs.</p>
<p>See <a href="https://github.com/hugoduncan/criterium/blob/bb10582ded6de31b4b985dc31d501db604c0e461/src/criterium/core.clj#L83"><code>criterium.core/*default-benchmark-opts*</code></a> and <a href="https://github.com/hugoduncan/criterium/blob/bb10582ded6de31b4b985dc31d501db604c0e461/src/criterium/core.clj#L92"><code>criterium.core/*default-quick-bench-opts*</code></a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L169">view source</a></div></div><div class="public anchor" id="var-*performance-testing-options*"><h3>*performance-testing-options*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Hashmap containing Criterium benchmarking options used during benchmarking. Defaults to <a href="https://github.com/hugoduncan/criterium/blob/bb10582ded6de31b4b985dc31d501db604c0e461/src/criterium/core.clj#L92"><code>criterium.core/*default-quick-bench-opts*</code></a>. Create a new binding evironment with <code>binding</code>.</p>
<p>Example:</p>
<pre><code class="language-clojure">(binding [*performance-testing-options* criterium.core/*default-benchmark-opts*]
  (do-one-performance-test (+ 1 2)))
</code></pre>
<p>See also <a href="https://github.com/hugoduncan/criterium/blob/bb10582ded6de31b4b985dc31d501db604c0e461/src/criterium/core.clj#L83"><code>criterium.core/*default-benchmark-opts*</code></a> and <a href="fastester.measure.html#var-*lightning-benchmark-opts*">*lightning-benchmark-opts*</a> for alternate values.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L154">view source</a></div></div><div class="public anchor" id="var-clear-performance-test-registry.21"><h3>clear-performance-test-registry!</h3><div class="usage"><code>(clear-performance-test-registry!)</code></div><div class="doc"><div class="markdown"><p>Remove all entries from <a href="fastester.measure.html#var-performance-test-registry">performance-test-registry</a>, thereby eliminating all defined benchmarking tests.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L50">view source</a></div></div><div class="public anchor" id="var-create-results-directories"><h3>create-results-directories</h3><div class="usage"><code>(create-results-directories excludes)</code></div><div class="doc"><div class="markdown"><p>Create directories to contain benchmarking results, location declared by options key <code>:results-directory</code>. Consults names contained in set <code>excludes</code>. If zero performance tests are to be executed (i.e., all tests are excluded), directories are not created.</p>
<p>Creates <code>&lt;options-results-dir&gt;/</code> then <code>&lt;options-results-dir&gt;/&lt;version&gt;/</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L111">view source</a></div></div><div class="public anchor" id="var-date"><h3>date</h3><div class="usage"><code>(date)</code></div><div class="doc"><div class="markdown"><p>Returns hashmap of <code>{:year YYYY :month M... :day DD}</code>.</p>
<p>Example:</p>
<pre><code class="language-clojure">(date) ;; =&gt; {:year 2025, :month "July", :day 16}
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L196">view source</a></div></div><div class="public anchor" id="var-defperf"><h3>defperf</h3><h4 class="type">macro</h4><div class="usage"><code>(defperf group f n)</code></div><div class="doc"><div class="markdown"><p>Define and register a performance test.</p>
<ul>
<li>
<p><code>group</code> is a string that links conceptually-related performance tests.</p>
</li>
<li>
<p><code>f</code> is a 1-arity function that measures some performance aspect. Its single argument is the “n” in <em>big-O</em> notation. <code>f</code> may be supplied as an S-expression or a function object. Supplying <code>f</code> as an S-expression has the advantage that the definition may later convey some meaning, e.g., <code>(fn [n] (+ n n))</code>, in the html charts and tables, whereas a function object will render less meaningfully, e.g., <code>#function[fastester.measure/eval11540/fn--11541]</code>.</p>
</li>
<li>
<p><code>n</code> is a sequence of one or more arguments. During performance testing, elements of <code>n</code> will be individually supplied to the benchmarking utility.</p>
</li>
</ul>
<p>Example, supplying <code>f</code> as an S-expression:</p>
<pre><code class="language-clojure">(defperf "benchmarking addition" (fn [n] (+ n n)) [1 10 100 1000])
</code></pre>
<p>Example, supplying <code>f</code> as a function object:</p>
<pre><code class="language-clojure">(defn my-fn-obj [q] (+ q q q))

(defperf "benchmarking additon" my-fn-obj [2 20 200 2000])
</code></pre>
<p>Both examples above share the same <code>group</code> label (“benchmarking addition”), both involving measuring the performance of <code>+</code>. Putting them in the same group signifies that they are conceptually associated, and the html displays will aggregate them under a single subsection. Also notice that the <code>n</code> sequences need not be identical.</p>
<p>Note 1: The registry ensures that every entry is unique, so repeated <code>defperf</code> invocations with identical arguments have no additional affects beyond the initial registration.</p>
<p>Note 2: Invoking a <code>defperf</code> expression, editing it, followed by invoking <code>defperf</code> a second time, registers two unique performance tests. When developing at the REPL, be aware that the registry may become ‘stale’ with outdated tests. To put the registry into a state that refelcts the current definitions, use <a href="fastester.measure.html#var-clear-performance-test-registry.21">clear-performance-test-registry!</a> and re-evaluate all <code>defperf</code>s (recommended) or edit the registry with, e.g., <code>disj</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L58">view source</a></div></div><div class="public anchor" id="var-do-all-performance-tests"><h3>do-all-performance-tests</h3><div class="usage"><code>(do-all-performance-tests)</code></div><div class="doc"><div class="markdown"><p>Execute all performance tests, ignoring options key <code>:excludes</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L377">view source</a></div></div><div class="public anchor" id="var-do-selected-performance-tests"><h3>do-selected-performance-tests</h3><div class="usage"><code>(do-selected-performance-tests)</code></div><div class="doc"><div class="markdown"><p>Execute performance tests, skipping any tests with name contained in option <code>:excludes</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L384">view source</a></div></div><div class="public anchor" id="var-performance-test-registry"><h3>performance-test-registry</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>An atom containing a set of benchmark tests to run. Typically populated with <a href="fastester.measure.html#var-defperf">defperf</a>, not manipulated directly.</p>
<p>See also <a href="fastester.measure.html#var-clear-performance-test-registry.21">clear-performance-test-registry!</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L46">view source</a></div></div><div class="public anchor" id="var-range-pow-10"><h3>range-pow-10</h3><div class="usage"><code>(range-pow-10 i)</code></div><div class="doc"><div class="markdown"><p>Given integer <code>i</code>, returns a sequence of <code>[10^0...10^i]</code>, inclusive. Useful for supplying to benchmarking functions.</p>
<p>Examples:</p>
<pre><code class="language-clojure">(range-pow-10 3) ;; =&gt; (1 10 100 1000)
(range-pow-10 6) ;; =&gt; (1 10 100 1000 10000 100000 1000000)
</code></pre>
<p>See also <a href="fastester.measure.html#var-range-pow-2">range-pow-2</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L415">view source</a></div></div><div class="public anchor" id="var-range-pow-2"><h3>range-pow-2</h3><div class="usage"><code>(range-pow-2 i)</code></div><div class="doc"><div class="markdown"><p>Given integer <code>i</code>, returns a sequence of <code>[2^0...2^i]</code>, inclusive. Useful for supplying to benchmarking functions.</p>
<p>Example:</p>
<pre><code class="language-clojure">(range-pow-2 8) ;; (1 2 4 8 16 32 64 128 256)
</code></pre>
<p>See also <a href="fastester.measure.html#var-range-pow-10">range-pow-10</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L431">view source</a></div></div><div class="public anchor" id="var-run-one-test"><h3>run-one-test</h3><div class="usage"><code>(run-one-test ver group f fexpr arg idx opts)</code></div><div class="doc"><div class="markdown"><p>Given version string <code>ver</code>, test group string <code>group</code>, function S-expression <code>f</code>, test argument <code>arg</code>, option hashmap <code>opts</code>, and index integer <code>idx</code>, executes the benchmark under the current settings and saves results to filesystem.</p>
<p>Example:</p>
<pre><code class="language-clojure">(run-one-test "77-SNAPSHOT7"
              "mapping --- stuff"
              '(fn [n] (* n n))
              22
              5
              options)
</code></pre>
<p>See <a href="fastester.measure.html#var-run-one-test-subroutine">run-one-test-subroutine</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L242">view source</a></div></div><div class="public anchor" id="var-run-one-test-subroutine"><h3>run-one-test-subroutine</h3><h4 class="type">macro</h4><div class="usage"><code>(run-one-test-subroutine fexpr arg)</code></div><div class="doc"><div class="markdown"><p>Given 1-arity function S-expression <code>fexpr</code> and argument <code>arg</code>, run one benchmark test using “lightning” thoroughness, sending result to *<code>out</code>*.</p>
<p>Example:</p>
<pre><code class="language-clojure">(run-one-test-subroutine '(fn [n] (+ n n)) 9)
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/blosavio/fastester/blob/main/src/fastester/measure.clj#L180">view source</a></div></div></div></body></html>